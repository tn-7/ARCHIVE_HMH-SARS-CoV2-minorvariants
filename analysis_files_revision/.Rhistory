hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none") +
scale_y_continuous(trans="log2")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(hss_1)
hss_2_plots<-hss_plots(hss_2)
hss_3_plots<-hss_plots(hss_3)
hss_4_plots = hss_plots(hss_4)
hss_5_plots = hss_plots(hss_5)
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_1<-sort(highly_shared_sites)[1:5]
hss_2<-sort(highly_shared_sites)[6:10]
hss_3<-sort(highly_shared_sites)[11:15]
hss_4<-sort(highly_shared_sites)[16:20]
hss_5<-sort(highly_shared_sites)[21:length(highly_shared_sites)]
# hss_6<-sort(highly_shared_sites)[26:30]
# hss_7<-sort(highly_shared_sites)[31:34]
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90)) +
scale_y_continuous(trans="log2")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(hss_1)
hss_2_plots<-hss_plots(hss_2)
hss_3_plots<-hss_plots(hss_3)
hss_4_plots = hss_plots(hss_4)
hss_5_plots = hss_plots(hss_5)
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90))
return(hss_1_plots)
}
hss_1<-sort(highly_shared_sites)[1:5]
hss_2<-sort(highly_shared_sites)[6:10]
hss_3<-sort(highly_shared_sites)[11:15]
hss_4<-sort(highly_shared_sites)[16:20]
hss_5<-sort(highly_shared_sites)[21:length(highly_shared_sites)]
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90))
return(hss_1_plots)
}
hss_1_plots<-hss_plots(hss_1)
hss_2_plots<-hss_plots(hss_2)
hss_3_plots<-hss_plots(hss_3)
hss_4_plots = hss_plots(hss_4)
hss_5_plots = hss_plots(hss_5)
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_1<-sort(highly_shared_sites)[1:5]
hss_2<-sort(highly_shared_sites)[6:10]
hss_3<-sort(highly_shared_sites)[11:15]
hss_4<-sort(highly_shared_sites)[16:20]
hss_5<-sort(highly_shared_sites)[21:length(highly_shared_sites)]
# hss_6<-sort(highly_shared_sites)[26:30]
# hss_7<-sort(highly_shared_sites)[31:34]
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none") +
scale_y_continuous(trans="log2", breaks = 2^(0:10))
return(hss_1_plots)
}
hss_1_plots<-hss_plots(hss_1)
hss_2_plots<-hss_plots(hss_2)
hss_3_plots<-hss_plots(hss_3)
hss_4_plots = hss_plots(hss_4)
hss_5_plots = hss_plots(hss_5)
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_1<-sort(highly_shared_sites)[1:5]
hss_2<-sort(highly_shared_sites)[6:10]
hss_3<-sort(highly_shared_sites)[11:15]
hss_4<-sort(highly_shared_sites)[16:20]
hss_5<-sort(highly_shared_sites)[21:length(highly_shared_sites)]
# hss_6<-sort(highly_shared_sites)[26:30]
# hss_7<-sort(highly_shared_sites)[31:34]
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none") +
scale_y_continuous(trans="log1p", breaks = 2^(0:10))
return(hss_1_plots)
}
hss_1_plots<-hss_plots(hss_1)
hss_2_plots<-hss_plots(hss_2)
hss_3_plots<-hss_plots(hss_3)
hss_4_plots = hss_plots(hss_4)
hss_5_plots = hss_plots(hss_5)
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_1<-sort(highly_shared_sites)[1:5]
hss_2<-sort(highly_shared_sites)[6:10]
hss_3<-sort(highly_shared_sites)[11:15]
hss_4<-sort(highly_shared_sites)[16:20]
hss_5<-sort(highly_shared_sites)[21:length(highly_shared_sites)]
# hss_6<-sort(highly_shared_sites)[26:30]
# hss_7<-sort(highly_shared_sites)[31:34]
hss_plots = function(hss_1, legend = F) {
hss_1_plots = consensus_minor_hss %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr()
if (legend == T) {
hss_1_plots = hss_1_plots + theme(axis.text.x=element_text(angle=90), legend.position="none")
}
return(hss_1_plots)
}
hss_1_plots<-hss_plots(hss_1, legend = T)
hss_2_plots<-hss_plots(hss_2)
hss_3_plots<-hss_plots(hss_3)
hss_4_plots = hss_plots(hss_4)
hss_5_plots = hss_plots(hss_5)
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_1<-sort(highly_shared_sites)[1:5]
hss_2<-sort(highly_shared_sites)[6:10]
hss_3<-sort(highly_shared_sites)[11:15]
hss_4<-sort(highly_shared_sites)[16:20]
hss_5<-sort(highly_shared_sites)[21:length(highly_shared_sites)]
# hss_6<-sort(highly_shared_sites)[26:30]
# hss_7<-sort(highly_shared_sites)[31:34]
hss_plots = function(hss_1, legend = F) {
hss_1_plots = consensus_minor_hss %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none")
if (legend == T) {
hss_1_plots = hss_1_plots + theme(axis.text.x=element_text(angle=90))
}
return(hss_1_plots)
}
hss_1_plots<-hss_plots(hss_1, legend = T)
hss_2_plots<-hss_plots(hss_2)
hss_3_plots<-hss_plots(hss_3)
hss_4_plots = hss_plots(hss_4)
hss_5_plots = hss_plots(hss_5)
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_1<-sort(highly_shared_sites)[1:5]
hss_2<-sort(highly_shared_sites)[6:10]
hss_3<-sort(highly_shared_sites)[11:15]
hss_4<-sort(highly_shared_sites)[16:20]
hss_5<-sort(highly_shared_sites)[21:length(highly_shared_sites)]
# hss_6<-sort(highly_shared_sites)[26:30]
# hss_7<-sort(highly_shared_sites)[31:34]
hss_plots = function(hss_1, legend = F) {
hss_1_plots = consensus_minor_hss %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none")
if (legend == T) {
hss_1_plots = hss_1_plots + theme(axis.text.x=element_text(angle=90), legend.position = "top")
}
return(hss_1_plots)
}
hss_1_plots<-hss_plots(hss_1, legend = T)
hss_2_plots<-hss_plots(hss_2)
hss_3_plots<-hss_plots(hss_3)
hss_4_plots = hss_plots(hss_4)
hss_5_plots = hss_plots(hss_5)
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
consensus_minor_hss
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(4)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(4)) + facet_grid(type~ntpos) +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
?facet_grid
hss_1_plots = consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") + scale_y_continuous(trans = "log1p") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none")
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") + scale_y_continuous(trans = "log1p") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
onsensus_minor_hss %>% na.omit() %>% filter(ntpos %in% hss_1)
consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% hss_1)
consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% 10319)
consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% 10319) %>% filter(type == "consensus")
consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% 10319) %>% filter(type == "consensus") %>% filter(run=="Run_11")
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
?theme
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90,size = 2), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>% na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90,size = 2), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
#all minor variants that are found in at least 2% of high-coverage samples in Lythgoe et al https://www.science.org/doi/suppl/10.1126/science.abg0821/suppl_file/abg0821-lythgoe-sm.pdf
lythgoe_hss<-c(29320, 25628, 25807, 20364, 357, 25627, 25532, 11083, 239, 238, 356, 16740, 20989, 19393, 15009, 21826, 19937, 26289,28253,25507,29862,11052,29864,25529,369,22453,13571,29538,21575,75,20993,19473,15474,635,1226,29747,24933,19210,13303,28936,26334,16887)
tonkin_hss<-c(11075L, 11083L, 11074L, 522L, 26780L, 1547L, 14408L, 28253L, 13914L, 26137L, 635L, 241L, 26785L, 683L, 23403L, 28881L, 13778L, 25521L, 14805L, 9491L, 11071L, 13780L, 21575L, 29242L, 9430L, 203L, 3037L, 686L, 3096L, 16375L, 16466L, 17167L, 23559L, 9438L, 21137L, 29051L, 23555L, 26333L, 9474L, 13571L, 16887L, 26787L, 28603L, 24213L, 11651L, 27925L, 514L, 26781L, 558L, 1912L, 9479L, 11073L, 12578L, 26144L, 26681L, 29241L)
intersect(lythgoe_hss, highly_shared_sites)
intersect(tonkin_hss, highly_shared_sites)
homoplasic_site_list<-c(187L, 1059L, 2094L, 3037L, 3130L, 6990L, 8022L, 10323L, 10741L, 11074L, 11083L, 13408L, 14786L, 15324L, 19684L, 20148L, 21137L, 21575L, 24034L, 24378L, 25563L, 26144L, 26461L, 26681L, 28077L, 28826L, 28854L, 29700L)
intersect(homoplasic_site_list, highly_shared_sites)
library(ggrepel)
tally_in_minors<-minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% group_by(ntpos) %>% summarise(n_minor_variants_houston=n()) %>% mutate(freq_minor_variants_houston=n_minor_variants_houston/nrow(p))
library(ggrepel)
tally_in_minors<-minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% group_by(ntpos) %>% summarise(n_minor_variants_houston=n()) %>% mutate(freq_minor_variants_houston=n_minor_variants_houston/nrow(patient_var_30))
tally_in_gisaid<-fread('hss_gisaid_tallies.csv', data.table = F) %>% select(ntpos, n_consensus_variants_gisaid=n) %>% mutate(freq_consensus_variants_gisaid=n_consensus_variants_gisaid/3109421) #USA gisaid sequences as of 6/13/2022
#SUPP FIG 10
left_join(tally_in_minors, tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_bw() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps=10, label.size=0.1)
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_cotninuous(trans = "log2") + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_cotninuous(trans = "log2") + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log2") + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log2", breaks = 2^(0:5)) + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log2", breaks = 2^(0:5)) + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log2", breaks = 2^(0:5)) + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log2", breaks = 2^(0:5)) + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log2", breaks = 2^(0:5)) + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log2", breaks = 2^(0:5)) + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log1p", breaks = 2^(0:5)) + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log1p", breaks = c(0,2^(0:5))) + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log1p", breaks = c(0,2^(0:5))) + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90), axis.text.y=element_text(size = 6))
#is appearance of these sites consistent over time?
minor_sites_lowct %>% filter(ntpos %in% highly_shared_sites) %>% ggplot(aes(COLLECTION_DT)) + geom_bar() + scale_y_continuous(trans = "log1p", breaks = c(0,2^(0:5))) + facet_wrap(~ntpos) + theme_pubr() + theme(axis.text.x=element_text(angle=90), axis.text.y=element_text(size = 8))
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>%
mutate(run = str_remove(run, "Run_")) %>%
na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90,size = 2), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>%
mutate(run = str_remove(run, "Run_") %>% as.numeric) %>%
na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90,size = 2), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>%
mutate(run = str_remove(run, "Run_") %>% as.numeric) %>%
na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none")
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>%
mutate(run = str_remove(run, "Run_") %>% as.numeric) %>%
na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none") +
x_scale_continous(breaks = seq(0,10,100))
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>%
mutate(run = str_remove(run, "Run_") %>% as.numeric) %>%
na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none") +
scale_x_continous(breaks = seq(0,10,100))
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>%
mutate(run = str_remove(run, "Run_") %>% as.numeric) %>%
na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none") +
scale_x_continuous(breaks = seq(0,10,100))
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
hss_plots = function(hss_1) {
hss_1_plots = consensus_minor_hss %>%
mutate(run = str_remove(run, "Run_") %>% as.numeric) %>%
na.omit() %>% filter(ntpos %in% hss_1) %>%
ggplot(aes(x=run, y=n, fill=nt)) + geom_bar(stat="identity") +
scale_fill_manual(values=viridis(5)) + facet_grid(type~ntpos, scales="free_y") +
theme_pubr() + theme(axis.text.x=element_text(angle=90), legend.position="none") +
scale_x_continuous(breaks = seq(0,100,10))
return(hss_1_plots)
}
hss_1_plots<-hss_plots(sort(highly_shared_sites)[1:5])
hss_2_plots<-hss_plots(sort(highly_shared_sites)[6:10])
hss_3_plots<-hss_plots(sort(highly_shared_sites)[11:15])
hss_4_plots = hss_plots(sort(highly_shared_sites)[16:20])
hss_5_plots = hss_plots(sort(highly_shared_sites)[21:length(highly_shared_sites)])
plot_grid(hss_1_plots, hss_2_plots, hss_3_plots, hss_4_plots, hss_5_plots, nrow=5)
#SUPP FIG 10
left_join(tally_in_minors, tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps=10, label.size=0.1)
#SUPP FIG 10
left_join(tally_in_minors, tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), label.size=0.1) + ylim(c(-1,1))
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos),max.overlaps = 1, label.size=0.1) + ylim(c(-1,1))
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos),max.overlaps = 10, label.size=0.1) + ylim(c(-1,1))
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1) + scale_y_continuous(trans="log")
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1) + scale_y_continuous(trans="log2")
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1) + scale_y_continuous(trans="log2") + scale_x_continuous(trans="log2")
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1) + scale_y_continuous(trans="log2") + scale_x_continuous(trans="log2")
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_text(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + scale_y_continuous(trans="log2") + scale_x_continuous(trans="log2")
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_text() + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + scale_y_continuous(trans="log2") + scale_x_continuous(trans="log2")
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, label = ntpos)) + geom_text(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + scale_y_continuous(trans="log2") + scale_x_continuous(trans="log2")
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, label = ntpos)) + geom_text(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA")
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, label = ntpos)) + geom_text_repel(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA")
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = ntpos)) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos), shape = as.factor(ntpos))) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) + theme_pubr(legend.position = "right") + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) + theme(legend.position = "right") + theme_pubr() + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) + theme(legend.position = "right") + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) + theme_pubr(legend.position = "right") + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
?theme_pubr
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) + theme_pubr(legend= "right") + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) + theme_pubr(legend= "right") + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1) + scale_y_continuous(trans="log1p")
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) + scale_y_continuous(trans="log1p")+ theme_pubr(legend= "right") + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) + scale_y_continuous(trans="log2")+ theme_pubr(legend= "right") + xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) +
scale_y_continuous(trans="log2", breaks = c(0,0.01*2^(0:5))) + theme_pubr(legend= "right") +
xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) +
scale_y_continuous(trans="log1p", breaks = c(0,0.01*2^(0:5))) + theme_pubr(legend= "right") +
xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) +
scale_y_continuous(trans="log1p", breaks = c(0,0.01*2^(0:6))) + theme_pubr(legend= "right") +
xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#SUPP FIG 10
tally_in_minors %>% left_join( tally_in_gisaid) %>% ggplot(aes(x=freq_minor_variants_houston, y=freq_consensus_variants_gisaid, color = as.factor(ntpos))) + geom_point(alpha=0.5) +
scale_y_continuous(trans="log1p") + theme_pubr(legend= "right") +
xlab("Fraction of samples with minor variant in Houston data") + ylab("Fraction of samples with consensus variant in GISAID USA") + geom_text_repel(aes(label=ntpos), max.overlaps = 10, label.size=0.1)
#FIG 3
plot_grid(genome_fig, plot_grid(var_by_gene_fig, hmap, nrow=2,labels=c("b","c")), ncol=2, rel_widths=c(2.5,1), labels=c("a",NULL))
# Across genome
minor_prevalence_across_genome<-minor_sites_lowct %>% ggplot(aes(x=ntpos)) + geom_bar(fill="black", color="black") + theme_bw() + geom_hline(yintercept = nrow(p)*0.02, linetype="dotted") + xlab("Nucleotide position") + ylab("No. samples w/minor variant at site") + annotate("rect", xmin=27894, xmax=28295, ymin=0, ymax=Inf, alpha=0.2, fill="#85D4E3") + annotate("rect", xmin=28274, xmax=29533, ymin=0, ymax=Inf, alpha=0.2, fill="#F4B5BD") + annotate("rect", xmin=21563, xmax=25384, ymin=0, ymax=Inf, alpha=0.2, fill="#FAD77B") + xlim(0,29903)
p
# Across genome
minor_prevalence_across_genome<-minor_sites_lowct %>% ggplot(aes(x=ntpos)) + geom_bar(fill="black", color="black") + theme_bw() + geom_hline(yintercept = nrow(patient_var_30)*0.02, linetype="dotted") + xlab("Nucleotide position") + ylab("No. samples w/minor variant at site") + annotate("rect", xmin=27894, xmax=28295, ymin=0, ymax=Inf, alpha=0.2, fill="#85D4E3") + annotate("rect", xmin=28274, xmax=29533, ymin=0, ymax=Inf, alpha=0.2, fill="#F4B5BD") + annotate("rect", xmin=21563, xmax=25384, ymin=0, ymax=Inf, alpha=0.2, fill="#FAD77B") + xlim(0,29903)
consensus_prevalence_across_genome<-consensus_sites_lowct %>% ggplot(aes(x=ntpos)) + geom_bar(fill="black", color="black") + theme_bw() + geom_hline(yintercept = nrow(patient_var_30)*0.02, linetype="dotted") + xlab("Nucleotide position") + ylab("No. samples w/consensus variant at site") + annotate("rect", xmin=27894, xmax=28295, ymin=0, ymax=Inf, alpha=0.2, fill="#85D4E3") + annotate("rect", xmin=28274, xmax=29533, ymin=0, ymax=Inf, alpha=0.2, fill="#F4B5BD") + annotate("rect", xmin=21563, xmax=25384, ymin=0, ymax=Inf, alpha=0.2, fill="#FAD77B") + xlim(0,29903)
prevalence_across_genome<-plot_grid(minor_prevalence_across_genome, consensus_prevalence_across_genome, nrow=2, axis="bltr")
prevalence_across_genome
prevalence_across_genome
consensus_sites_lowct
